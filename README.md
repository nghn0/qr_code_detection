# QR Code Detection with YOLOv8  

This repository contains the complete source code for **training** and **inference** of a YOLOv8 model to detect QR codes in images.  

The project prepares a dataset and splits the dataset, trains YOLOv8, and runs inference on test images, outputting bounding boxes in both **annotated images** and a **JSON file**.  

---

## 📂 Project Structure  

```
├── labels/
│   ├── img001.txt
│   ├── img002.txt
│   ├── ...
│   └── all YOLO-annotated txt files for the train_images in QR_Dataset/
│
├── QR_Dataset/
│   ├── train_images/        # Training images
│   ├── test_images/         # Test images for inference
│   ├── labels/              # YOLO format label files (.txt) with split of 80% training and 20% validation. Generated by running train.py
│   │   ├── train/
│   │   └── val/
│   ├── images/              #split of 80% training and 20% validation from the train_images in QR_Dataset. Generated by running train.py
│   │   ├── train/
│   │   └── val/
│   └── data.yaml            # Auto-generated by running train.py
│
├── src/
│   └── model/               # YOLO training outputs (weights, logs)
│
├── outputs/
│   ├── image_output/        # Annotated inference images
│   └── submission.json      # Final detection results
│
├── train.py                 # Training script
├── infer.py                 # Inference script
├── requirements.txt
└── README.md                # Project documentation

```
---

## ⚙️ Environment Setup 

### 1️⃣ Install requirements.txt  
```bash
pip install -r requirements.txt
```

### 2️⃣ Install dependencies  
```bash
pip install ultralytics
```


## 🚀 Training  

Run the training script to prepare the dataset and train YOLOv8:  

```bash
python train.py
```

This will:  
- Split your dataset into train/val  
- Generate `data.yaml`  
- Train YOLOv8 for 50 epochs  
- Save the best model in `src/model/qr_yolo_model_aug/weights/best.pt`  

### Original structure of dataset before running train.py

```
├── QR_Dataset/
   ├── train_images/        # Training images
   ├── test_images/         # Test images for inference
```

### Structure of dataset after running train.py

```
├── QR_Dataset/
   ├── train_images/        # Training images
   ├── test_images/         # Test images for inference
   ├── labels/              # YOLO format label files (.txt) with split of 80% training and 20% validation. Generated by running train.py
   │   ├── train/
   │   └── val/
   ├── images/              #split of 80% training and 20% validation from the train_images in QR_Dataset. Generated by running train.py
   │   ├── train/
   │   └── val/
   └── data.yaml            # Auto-generated by running train.py
```

---

## 🔎 Inference  

Run inference on a folder of test images:  

```bash
python infer.py
```
> [!NOTE]  
> In the ```infer.py``` script, update the line
> ```bash
> IMAGES_FOLDER = "QR_Dataset/test_images"
> ```
> to your own custom folder path. This tells the code where to look for images, and the output (annotated images and JSON) will be generated based on the images inside that folder.

> [!NOTE]  
> In the ```infer.py``` script, make sure this line
> ```bash
> MODEL_PATH = "src/model/qr_yolo_model_aug/weights/best.pt"
> ```
> properly points to weight ```best.pt``` generated by the model in ```src/model```


This will:  
- Load your trained YOLOv8 model  
- Run inference on all `.jpg` / `.png` images in the input folder  
- Save annotated images in `outputs/image_output/`  
- Save detection results in `outputs/submission.json`  

Example JSON output:  
```json
[
  {
    "image_id": "image_001",
    "qrs": [
      {"bbox": [34, 45, 120, 200]}
    ]
  },
  {
    "image_id": "image_002",
    "qrs": []
  }
]
```
